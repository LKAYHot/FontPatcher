<Window xmlns="https://github.com/avaloniaui"
		xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
		xmlns:vm="using:FontPatcher.Avalonia.ViewModels"
		xmlns:sections="using:FontPatcher.Avalonia.Views.Sections"
		xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
		xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
		mc:Ignorable="d"
		x:Class="FontPatcher.Avalonia.Views.MainWindow"
		x:DataType="vm:MainWindowViewModel"
		Width="1340"
		Height="820"
		MinWidth="1220"
		MinHeight="740"
		Title="UnityFontPatcher"
		Icon="/Assets/avalonia-logo.ico"
		SystemDecorations="BorderOnly"
		ExtendClientAreaToDecorationsHint="True"
		ExtendClientAreaChromeHints="NoChrome"
		ExtendClientAreaTitleBarHeightHint="34"
		WindowStartupLocation="CenterScreen"
		Background="#0A0F1D">

	<Design.DataContext>
		<vm:MainWindowViewModel />
	</Design.DataContext>

	<Window.Styles>
		<Style Selector="Path.icon">
			<Setter Property="Stroke" Value="#7C8EA8" />
			<Setter Property="StrokeThickness" Value="1.8" />
			<Setter Property="StrokeLineCap" Value="Round" />
			<Setter Property="Width" Value="18" />
			<Setter Property="Height" Value="18" />
			<Setter Property="Stretch" Value="Uniform" />
		</Style>
	</Window.Styles>

	<Grid RowDefinitions="34,*">
		<Border Grid.Row="0" Classes="window-titlebar" PointerPressed="OnTitleBarPointerPressed">
			<Grid ColumnDefinitions="Auto,*,Auto" Margin="12,0,0,0">
				<StackPanel Orientation="Horizontal" Spacing="10" VerticalAlignment="Center" IsHitTestVisible="False">
					<Border Width="18" Height="18" CornerRadius="6" Background="#2563EB">
						<Path Data="M12 2L2 7L12 12L22 7L12 2 M2 12L12 17L22 12 M2 17L12 22L22 17"
							  Width="10"
							  Height="10"
							  Stretch="Uniform"
							  Stroke="White"
							  StrokeThickness="1.4"
							  HorizontalAlignment="Center"
							  VerticalAlignment="Center" />
					</Border>
					<StackPanel Spacing="0" VerticalAlignment="Center">
						<TextBlock Text="Unity Font Patcher" Classes="window-title-text" />
					</StackPanel>
				</StackPanel>
				<Border Grid.Column="1" Background="Transparent" />
					<StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right">
						<Button Classes="caption-button" Click="OnMinimizeWindowClick">
							<Border Width="10"
									Height="1.6"
									CornerRadius="0.8"
									Background="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
									HorizontalAlignment="Center"
									VerticalAlignment="Center" />
						</Button>
						<Button Classes="caption-button" Click="OnMaximizeRestoreWindowClick">
							<Path Classes="caption-icon"
								  Width="10"
							  Height="10"
							  StrokeThickness="1.5"
							  Stroke="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
							  Data="M1.5 1.5H10.5V10.5H1.5Z M1.5 4.5H10.5" />
					</Button>
					<Button Classes="caption-button caption-close" Click="OnCloseWindowClick">
						<Path Classes="caption-icon"
							  Width="10"
							  Height="10"
							  Margin="0,0,1,0"
							  StrokeThickness="1.5"
							  Stroke="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
							  Data="M2 2L10 10 M10 2L2 10" />
					</Button>
				</StackPanel>
			</Grid>
		</Border>

		<Grid Grid.Row="1">
		<Grid ColumnDefinitions="222,*" IsVisible="{Binding IsMainLayoutVisible}">
			<Border Grid.Column="0"
					Background="#0B1428"
					BorderBrush="#1F2937"
					BorderThickness="0,0,1,0">
				<Grid RowDefinitions="94,*,152">
					<Border BorderBrush="#1F2937" BorderThickness="0,0,0,1" Padding="14,16,14,14">
						<StackPanel Orientation="Horizontal" Spacing="12" VerticalAlignment="Center">
							<Border Width="34" Height="34" CornerRadius="11" Background="#2563EB" Classes="logo-badge">
								<Path Data="M12 2L2 7L12 12L22 7L12 2 M2 12L12 17L22 12 M2 17L12 22L22 17"
									  Width="17"
									  Height="17"
									  Stretch="Uniform"
									  Stroke="White"
									  StrokeThickness="1.7"
									  HorizontalAlignment="Center"
									  VerticalAlignment="Center" />
							</Border>

							<StackPanel Spacing="0" VerticalAlignment="Center">
								<TextBlock Text="Main"
										   FontSize="18"
										   FontWeight="Bold"
										   Foreground="White"
										   TextTrimming="CharacterEllipsis" />
								<TextBlock Text="BUNDLE ENGINE"
										   FontSize="11"
										   FontWeight="Bold"
										   Foreground="#64748B"
										   LetterSpacing="1.3" />
							</StackPanel>
						</StackPanel>
					</Border>

					<StackPanel Grid.Row="1" Margin="14,16,14,0" Spacing="3">
						<TextBlock Margin="12,8,0,7"
								   Text="WORKSPACE"
								   FontSize="10"
								   FontWeight="Bold"
								   Foreground="#475569"
								   LetterSpacing="1.2" />

						<Button Classes="nav"
								HorizontalAlignment="Stretch"
								Classes.active="{Binding IsSingleTabActive}"
								Command="{Binding OpenSingleModeCommand}">
							<StackPanel Orientation="Horizontal" Spacing="10">
								<Path Classes="icon"
									  Stroke="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
									  Data="M14.5 2H6A2 2 0 0 0 4 4V20A2 2 0 0 0 6 22H18A2 2 0 0 0 20 20V7.5L14.5 2 M14 2V8H20" />
								<TextBlock Text="Single Converter" VerticalAlignment="Center" />
							</StackPanel>
						</Button>

						<Button Classes="nav nav-batch"
								HorizontalAlignment="Stretch"
								Classes.active="{Binding IsBatchTabActive}"
								Command="{Binding OpenBatchModeCommand}">
							<StackPanel Orientation="Horizontal" Spacing="10">
								<Path Classes="icon"
									  Stroke="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
									  Data="M6 4H18A2 2 0 0 1 20 6V18A2 2 0 0 1 18 20H6A2 2 0 0 1 4 18V6A2 2 0 0 1 6 4 M9 9H15V15H9V9 M9 1V4 M15 1V4 M9 20V23 M15 20V23 M20 9H23 M20 15H23 M1 9H4 M1 15H4" />
								<TextBlock Text="Batch Processor" VerticalAlignment="Center" />
							</StackPanel>
						</Button>

						<TextBlock Margin="12,16,0,7"
								   Text="PREFERENCES"
								   FontSize="10"
								   FontWeight="Bold"
								   Foreground="#475569"
								   LetterSpacing="1.2" />

						<Button Classes="config"
								HorizontalAlignment="Stretch"
								Classes.active="{Binding IsUnityTabActive}"
								Command="{Binding OpenUnityCommand}">
							<StackPanel Orientation="Horizontal" Spacing="10">
								<Path Classes="icon"
									  Stroke="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
									  Data="M12 8A4 4 0 1 0 12 16A4 4 0 1 0 12 8 M12 2V5 M12 19V22 M2 12H5 M19 12H22 M4.9 4.9L7 7 M17 17L19.1 19.1 M4.9 19.1L7 17 M17 7L19.1 4.9" />
								<TextBlock Text="Unity SDK" VerticalAlignment="Center" />
							</StackPanel>
						</Button>

						<Button Classes="config"
								HorizontalAlignment="Stretch"
								Classes.active="{Binding IsAdvancedTabActive}"
								Command="{Binding OpenAdvancedCommand}">
							<StackPanel Orientation="Horizontal" Spacing="10">
								<Path Classes="icon"
									  Stroke="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
									  Data="M4 17L10 11L4 5 M12 19H20" />
								<TextBlock Text="Rendering Options" VerticalAlignment="Center" />
							</StackPanel>
						</Button>
					</StackPanel>

					<Border Grid.Row="2" BorderBrush="#1F2937" BorderThickness="0,1,0,0" Padding="14,14,14,14">
						<StackPanel Spacing="12">
							<Border IsVisible="{Binding ShowBuildWarning}" Classes="warning-card">
								<TextBlock Text="Complete all required steps to enable build." Classes="warning-text" TextWrapping="Wrap" />
							</Border>
							<Border IsVisible="{Binding CanRunBuild}" Classes="ready-card">
								<TextBlock Text="Everything is ready to launch build. Press RUN BUILD to start."
										   Classes="ready-text"
										   TextWrapping="Wrap" />
							</Border>

							<Button Classes="start-build"
									HorizontalAlignment="Stretch"
									IsEnabled="{Binding CanRunBuild}"
									Command="{Binding StartBuildCommand}">
								<StackPanel Orientation="Horizontal"
											HorizontalAlignment="Center"
											VerticalAlignment="Center"
											Spacing="0">
									<Viewbox Width="24" Height="24" VerticalAlignment="Center" Margin="0, 0, 0, 0">
									<Path Classes="icon"
		                                  Stroke="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
										  Margin="4,4,4,4"
										  Width="16"
										  Height="12"
										  StrokeThickness="2"
										  StrokeLineCap="Round"
										  HorizontalAlignment="Center"
										  VerticalAlignment="Center"
										  Data="M5 3L19 12L5 21Z" />
						</Viewbox>
									
									<TextBlock Text="{Binding RunBuildButtonText}"
											   FontWeight="SemiBold"
											   FontSize="13"
											   LetterSpacing="0.3"
											   VerticalAlignment="Center" />
								</StackPanel>
							</Button>
						</StackPanel>
					</Border>
				</Grid>
			</Border>

			<Grid Grid.Column="1" RowDefinitions="62,*,196">
				<Border Grid.Row="0"
						Background="#0B1730"
						BorderBrush="#1F2937"
						BorderThickness="0,0,0,1"
						Padding="34,0">
					<Grid ColumnDefinitions="*,Auto" VerticalAlignment="Center">
						<StackPanel Orientation="Horizontal" Spacing="12" VerticalAlignment="Center">
							<TextBlock Text="Status" FontSize="13" FontWeight="SemiBold" Foreground="#7D91AF" />
							<Border Width="1" Height="16" Background="#1F2937" />

							<Border Classes="status-dot processing" IsVisible="{Binding IsStatusProcessing}" />
							<Border Classes="status-dot ready" IsVisible="{Binding IsStatusReady}" />
							<Border Classes="status-dot pending" IsVisible="{Binding IsStatusPending}" />
							<TextBlock Text="{Binding StatusText}" Classes="status-text" />
						</StackPanel>

						<StackPanel Grid.Column="1" HorizontalAlignment="Right" VerticalAlignment="Center" Spacing="1">
							<TextBlock Text="TARGET PLATFORM"
									   HorizontalAlignment="Right"
									   FontSize="10"
									   FontWeight="Bold"
									   Foreground="#637A9B"
									   LetterSpacing="1.1" />
							<TextBlock Text="{Binding TargetPlatformText}"
									   HorizontalAlignment="Right"
									   FontSize="14"
									   FontFamily="{StaticResource FontMono}"
									   Foreground="#60A5FA" />
						</StackPanel>
					</Grid>
				</Border>

				<Border Grid.Row="1" Background="#0A1226">
					<ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
						<Grid HorizontalAlignment="Center" Width="860" Margin="26,26,26,28">
							<sections:SingleModeSectionView IsVisible="{Binding IsSingleSectionVisible}" />
							<sections:BatchModeSectionView IsVisible="{Binding IsBatchSectionVisible}" />
							<sections:UnitySectionView IsVisible="{Binding IsUnitySectionVisible}" />
							<sections:AdvancedSectionView IsVisible="{Binding IsAdvancedSectionVisible}" />
						</Grid>
					</ScrollViewer>
				</Border>

				<Border Grid.Row="2"
						Background="#050914"
						BorderBrush="#1F2937"
						BorderThickness="0,1,0,0">
					<Grid RowDefinitions="40,*">
						<Border Grid.Row="0"
								Background="#0F172A"
								BorderBrush="#1F2937"
								BorderThickness="0,0,0,1"
								Padding="20,0">
							<Grid ColumnDefinitions="*,Auto,Auto" VerticalAlignment="Center">
								<StackPanel Orientation="Horizontal" Spacing="16" VerticalAlignment="Center">
									<StackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
										<Viewbox Width="12" Height="12" VerticalAlignment="Center" Margin="0, 3, 0, 0">
											<Path Classes="icon"
												  Data="M4 17L10 11L4 5 M12 19H20" StrokeThickness="4" Margin="2"
												  />
										</Viewbox>
										<TextBlock Text="REAL-TIME BUILD LOG" Classes="log-header-text" />
									</StackPanel>

									<StackPanel IsVisible="{Binding HasProgress}"
												Orientation="Horizontal"
												Spacing="12"
												VerticalAlignment="Center">
										<ProgressBar Classes="console"
													 Minimum="0"
													 Maximum="100"
													 Value="{Binding BuildProgress}" />
										<TextBlock Text="{Binding ProgressLabel}"
												   FontSize="10"
												   FontWeight="Bold"
												   Foreground="#60A5FA"
												   FontFamily="{StaticResource FontMono}" />
									</StackPanel>
								</StackPanel>

								<Button Grid.Column="1"
										Classes="console-link"
										Content="{Binding LogViewToggleText}"
										Command="{Binding ToggleLogFullscreenCommand}" />

								<Button Grid.Column="2"
										Classes="console-link"
										Content="FLUSH LOGS"
										Command="{Binding FlushLogsCommand}" />
							</Grid>
						</Border>

						<Grid Grid.Row="1" Margin="18,10,18,12">
							<StackPanel IsVisible="{Binding IsLogEmpty}"
										VerticalAlignment="Center"
										HorizontalAlignment="Center"
										Spacing="8">
								<Path Classes="icon"
									  Width="20"
									  Height="20"
									  Stroke="#1E293B"
									  Data="M4 17L10 11L4 5 M12 19H20" />
								<TextBlock Text="Waiting for build initialization..."
										   FontFamily="{StaticResource FontMono}"
										   FontSize="12"
										   Foreground="#1E293B" />
							</StackPanel>

							<ListBox x:Name="LogList"
									 Classes="console-logs"
									 IsVisible="{Binding HasLogs}"
									 ItemsSource="{Binding Logs}"
									 SelectionMode="Multiple"
									 KeyDown="OnLogListKeyDown">
								<ListBox.ContextMenu>
									<ContextMenu>
										<MenuItem Header="Copy Selected" Click="OnCopySelectedLogsClick" />
										<MenuItem Header="Copy All" Click="OnCopyAllLogsClick" />
									</ContextMenu>
								</ListBox.ContextMenu>
								<ListBox.ItemsPanel>
									<ItemsPanelTemplate>
										<VirtualizingStackPanel />
									</ItemsPanelTemplate>
								</ListBox.ItemsPanel>

								<ListBox.ItemTemplate>
									<DataTemplate x:DataType="vm:LogLineViewModel">
										<Grid ColumnDefinitions="Auto,Auto,*" ColumnSpacing="10" Margin="0,0,0,4">
											<TextBlock Grid.Column="0"
													   Text="{Binding TimestampText}"
													   FontSize="11"
													   Foreground="#334155"
													   FontFamily="{StaticResource FontMono}" />
											<TextBlock Grid.Column="1"
													   Text="{Binding LevelText}"
													   FontSize="11"
													   FontWeight="Bold"
													   Foreground="{Binding LevelBrush}"
													   FontFamily="{StaticResource FontMono}"
													   MinWidth="66" />
											<TextBlock Grid.Column="2"
													   Text="{Binding Message}"
													   TextWrapping="Wrap"
													   FontSize="11"
													   Foreground="#CBD5E1"
													   FontFamily="{StaticResource FontMono}" />
										</Grid>
									</DataTemplate>
								</ListBox.ItemTemplate>
							</ListBox>
						</Grid>
					</Grid>
				</Border>
			</Grid>
		</Grid>

		<Border IsVisible="{Binding IsLogFullscreenVisible}"
				Background="#050914">
			<Grid RowDefinitions="48,*">
				<Border Grid.Row="0"
						Background="#0F172A"
						BorderBrush="#1F2937"
						BorderThickness="0,0,0,1"
						Padding="20,0">
					<Grid ColumnDefinitions="*,Auto,Auto" VerticalAlignment="Center">
						<StackPanel Orientation="Horizontal" Spacing="16" VerticalAlignment="Center">
							<StackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
								<Path Classes="icon" Data="M4 17L10 11L4 5 M12 19H20" />
								<TextBlock Text="REAL-TIME BUILD LOG" Classes="log-header-text" />
							</StackPanel>

							<StackPanel IsVisible="{Binding HasProgress}"
										Orientation="Horizontal"
										Spacing="12"
										VerticalAlignment="Center">
								<ProgressBar Classes="console"
											 Minimum="0"
											 Maximum="100"
											 Value="{Binding BuildProgress}" />
								<TextBlock Text="{Binding ProgressLabel}"
										   FontSize="10"
										   FontWeight="Bold"
										   Foreground="#60A5FA"
										   FontFamily="{StaticResource FontMono}" />
							</StackPanel>
						</StackPanel>

						<Button Grid.Column="1"
								Classes="console-link"
								Content="FLUSH LOGS"
								Command="{Binding FlushLogsCommand}" />

						<Button Grid.Column="2"
								Classes="console-link"
								Content="{Binding LogViewToggleText}"
								Command="{Binding ToggleLogFullscreenCommand}" />
					</Grid>
				</Border>

				<Grid Grid.Row="1" Margin="18,10,18,12">
					<StackPanel IsVisible="{Binding IsLogEmpty}"
								VerticalAlignment="Center"
								HorizontalAlignment="Center"
								Spacing="8">
						<Path Classes="icon"
							  Width="20"
							  Height="20"
							  Stroke="#1E293B"
							  Data="M4 17L10 11L4 5 M12 19H20" />
						<TextBlock Text="Waiting for build initialization..."
								   FontFamily="{StaticResource FontMono}"
								   FontSize="12"
								   Foreground="#1E293B" />
					</StackPanel>

					<ListBox x:Name="FullLogList"
							 Classes="console-logs"
							 IsVisible="{Binding HasLogs}"
							 ItemsSource="{Binding Logs}"
							 SelectionMode="Multiple"
							 KeyDown="OnLogListKeyDown">
						<ListBox.ContextMenu>
							<ContextMenu>
								<MenuItem Header="Copy Selected" Click="OnCopySelectedLogsClick" />
								<MenuItem Header="Copy All" Click="OnCopyAllLogsClick" />
							</ContextMenu>
						</ListBox.ContextMenu>
						<ListBox.ItemsPanel>
							<ItemsPanelTemplate>
								<VirtualizingStackPanel />
							</ItemsPanelTemplate>
						</ListBox.ItemsPanel>

						<ListBox.ItemTemplate>
							<DataTemplate x:DataType="vm:LogLineViewModel">
								<Grid ColumnDefinitions="Auto,Auto,*" ColumnSpacing="10" Margin="0,0,0,4">
									<TextBlock Grid.Column="0"
											   Text="{Binding TimestampText}"
											   FontSize="11"
											   Foreground="#334155"
											   FontFamily="{StaticResource FontMono}" />
									<TextBlock Grid.Column="1"
											   Text="{Binding LevelText}"
											   FontSize="11"
											   FontWeight="Bold"
											   Foreground="{Binding LevelBrush}"
											   FontFamily="{StaticResource FontMono}"
											   MinWidth="66" />
									<TextBlock Grid.Column="2"
											   Text="{Binding Message}"
											   TextWrapping="Wrap"
											   FontSize="11"
											   Foreground="#CBD5E1"
											   FontFamily="{StaticResource FontMono}" />
								</Grid>
							</DataTemplate>
						</ListBox.ItemTemplate>
					</ListBox>
				</Grid>
			</Grid>
		</Border>
	</Grid>

</Grid>
</Window>
